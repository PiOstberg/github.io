<!DOCTYPE html>
<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/fav/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/fav/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/fav/favicon-16x16.png">
    <link rel="manifest" href="/images/fav/site.webmanifest">
    <title>Pi Östberg</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/custom.css">
    <script src="/js/card-hover.js" defer></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo:ital,wght@0,100..900;1,100..900&family=Jost:ital,wght@0,100..900;1,100..900&family=Mina:wght@400;700&display=swap" rel="stylesheet">
</head><body><header>
    <div class="logo">
        <a href="https://portfolio.argo.re/">
            <img src="/images/logo.png" alt="Site Logo">
        </a>
    </div>

    <div class="social-media">
        
        <a href="https://github.com/argoreofficial"><img src="https://cdn.simpleicons.org/github/white" alt="Github"></a>
        
        <a href="https://argore.itch.io"><img src="https://cdn.simpleicons.org/itchdotio/white" alt="Itch.io"></a>
        
        <a href="mailto:ostbergpi@gmail.com"><img src="https://cdn.simpleicons.org/gmail/white" alt="Email"></a>
        
        <a href="https://www.linkedin.com/in/pi-%c3%b6stberg/"><img src="https://cdn.simpleicons.org/linkedin/white" alt="Linkedin"></a>
        
    </div>
</header>



<section class="hero"
    style='background-image: url("/images/banner/beetlebot.png"); background-size: cover; background-position: center; background-repeat: no-repeat; width: 100%;'
    id="heroSection" onload="adjustTextColor(this)">
    <div>
        <h1 id="textOverlay">Beetlebot</h1>
        <h2 class="subtitle">small dungeon crawler with even smaller enemies</h2>
    </div>
</section>
<main class="post">
    <p>Beetlebot is a 4 level dungeon crawler. It was our first game project at PlaygroundSquad and made in the game engine TenGine.<br>
I was tasked with building most of the core systems powering the game, such as the physics, collision detection, enemy pathfinding, as well as providing platform support for the PlayStation 5.</p>
<p>For this project I implemented :</p>
<ul>
<li>Physics and Collisions</li>
<li>Pathfinding</li>
<li>PlayStation®5 DualSense Haptic Feedback</li>
<li>Video Playback</li>
<li>Miscellaneous entity systems</li>
</ul>
<div class="video-container">
    <div class="auto-resizable-iframe">
        <div><iframe frameborder="0" allowfullscreen="" src="https://www.youtube.com/embed/G-td76fZ01g?si=Ianls67Zz_aBeXAx"></iframe></div>
    </div>
    <div class="auto-resizable-iframe">
        <div><iframe frameborder="0" allowfullscreen="" src="https://www.youtube.com/embed/W5Uf3M3wklg?si=CCXDGPvOXxBachXq"></iframe></div>
    </div>
</div>
<hr>
<h2 id="entity-collisions">Entity Collisions</h2>
<p>Entity-Entity and Entity-Static World collisions.</p>
<p><img src="/images/beetlebot-collision.png" alt=""></p>
<p>The collision code is some 600 lines of code so I won&rsquo;t post that here</p>
<hr>
<h2 id="masse-pathfinding">Masse Pathfinding</h2>
<p><img src="/images/beetlebot-pathfinding.gif" alt=""><br>
<sup>Early pathfinding test with a navmesh. Early on it was just a basic floodfill algorithm</sup></p>
<div style="max-width: 720px"> 
    <video controls style="object-fit: cover; width: 100%;">
    <source src="/videos/beetlebot-stresstesting.mp4" type="video/mp4"> Your browser does not support the video tag. </video>
</div>
<sup>The grid shown is an optimization to reduce the amount of navmesh lookups. </sup>
<h3 id="cnavmeshcpp">cNavmesh.cpp</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> cNavmesh<span style="color:#f92672">::</span>getNodeClosestToPosition( <span style="color:#66d9ef">const</span> tg<span style="color:#f92672">::</span>cVector3f<span style="color:#f92672">&amp;</span> _position )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> closest   <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">float</span> closest_distance <span style="color:#f92672">=</span> <span style="color:#ae81ff">100000.0f</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">int</span> chunk_pos <span style="color:#f92672">=</span> worldToChunkIndex( _position );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> ( chunk_pos.y <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> chunk_pos.y <span style="color:#f92672">&gt;=</span> m_chunk_count <span style="color:#f92672">||</span> chunk_pos.x <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">||</span> chunk_pos.x <span style="color:#f92672">&gt;=</span> m_chunk_count )
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	std<span style="color:#f92672">::</span>vector<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">&gt;&amp;</span> chunk <span style="color:#f92672">=</span> m_node_chunks[ chunk_pos.y ][ chunk_pos.x ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> ( size_t i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> chunk.size(); i<span style="color:#f92672">++</span> )
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">float</span> distance <span style="color:#f92672">=</span> ( m_nodes[ chunk[ i ] ].position <span style="color:#f92672">-</span> _position ).length();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> ( distance <span style="color:#f92672">&gt;</span> closest_distance )
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		closest_distance <span style="color:#f92672">=</span> distance;
</span></span><span style="display:flex;"><span>		closest <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)chunk[ i ];
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> closest;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="video-playback-system-sound-warning">Video Playback System (sound warning)</h2>
<p>Test of the video playback system implemented on Windows. It was relatively easy to port it to the PlayStation 5 with minimal stutter.<br>
<sup>I claim no ownership of the Aperture logo. All rights go to The Valve Corporation</sup></p>
<div style="max-width: 720px">
    <video controls style="object-fit: cover; width: 100%;">
    <source src="/videos/beetlebot-video-player.mp4" type="video/mp4"> Your browser does not support the video tag. </video>
</div>
<h3 id="cvideocpp">cVideo.cpp</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>cVideo<span style="color:#f92672">::</span>cVideo( <span style="color:#66d9ef">const</span> std<span style="color:#f92672">::</span>string<span style="color:#f92672">&amp;</span> _filename )
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string dir_path      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;data/videos/&#34;</span> <span style="color:#f92672">+</span> _filename <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span>;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string frames_path   <span style="color:#f92672">=</span> dir_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;frames/&#34;</span>;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string settings_path <span style="color:#f92672">=</span> dir_path <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;movie-settings.json&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span><span style="color:#f92672">*</span> data <span style="color:#f92672">=</span> tg<span style="color:#f92672">::</span>cFileSystem<span style="color:#f92672">::</span>getInstance().fileLoad( settings_path );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>data ) <span style="color:#75715e">// failed to load settings
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    nlohmann<span style="color:#f92672">::</span>json json_root <span style="color:#f92672">=</span> nlohmann<span style="color:#f92672">::</span>json<span style="color:#f92672">::</span>parse( data );
</span></span><span style="display:flex;"><span>    TG_MEMORY_FREE( data );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m_framerate <span style="color:#f92672">=</span> json_root.value( <span style="color:#e6db74">&#34;framerate&#34;</span>, <span style="color:#ae81ff">24.0f</span> );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string audio_path <span style="color:#f92672">=</span> json_root.value( <span style="color:#e6db74">&#34;audio&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span> );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    loadFrameList( dir_path );
</span></span><span style="display:flex;"><span>    loadFrames();
</span></span><span style="display:flex;"><span>    catchFrames();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>( audio_path <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;&#34;</span> )
</span></span><span style="display:flex;"><span>        m_audio <span style="color:#f92672">=</span> cAudio<span style="color:#f92672">::</span>getInstance().createAudioFile( dir_path <span style="color:#f92672">+</span> audio_path );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    m_sprite <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> tg<span style="color:#f92672">::</span>cSprite();
</span></span><span style="display:flex;"><span>    m_sprite<span style="color:#f92672">-&gt;</span>create( _name, { <span style="color:#ae81ff">1920.0f</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">1.0f</span>, <span style="color:#ae81ff">1080.0f</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.0f</span>, <span style="color:#ae81ff">0</span> }, { <span style="color:#ae81ff">1920</span>, <span style="color:#ae81ff">1080</span> }, tg<span style="color:#f92672">::</span>Color<span style="color:#f92672">::</span>kWhite, <span style="color:#66d9ef">nullptr</span> );
</span></span><span style="display:flex;"><span>    m_sprite<span style="color:#f92672">-&gt;</span>setTexCoords( <span style="color:#ae81ff">1.0f</span>, <span style="color:#ae81ff">0.0f</span>, <span style="color:#ae81ff">1.0f</span>, <span style="color:#ae81ff">0.0f</span> );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
</main>
<script>
    function adjustTextColor(sectionId) {
        const section = document.getElementById(sectionId);
        const style = window.getComputedStyle(section);
        const imageUrl = style.backgroundImage.slice(4, -1).replace(/["']/g, "");
        const image = new Image();
        image.src = imageUrl;
        image.onload = function () {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = image.width;
            canvas.height = image.height;
            context.drawImage(image, 0, 0, image.width, image.height);
            const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            let r = 0, g = 0, b = 0;
            for (let i = 0; i < data.length; i += 4) {
                r += data[i];
                g += data[i + 1];
                b += data[i + 2];
            }
            r /= (data.length / 4);
            g /= (data.length / 4);
            b /= (data.length / 4);
            const brightness = Math.sqrt(0.299 * r * r + 0.587 * g * g + 0.114 * b * b);
            const textColor = brightness > 128 ? 'black' : 'white';
            const shadowColor = brightness > 128 ? 'rgba(255, 255, 255, 0.7)' : 'rgba(0, 0, 0, 0.7)';
            const textOverlay = document.getElementById('textOverlay');
            textOverlay.style.color = textColor;
            textOverlay.style.textShadow = `0 0 5px ${shadowColor}, 0 0 10px ${shadowColor}, 0 0 20px ${shadowColor}, 0 0 40px ${shadowColor}, 0 0 80px ${shadowColor}, 0 0 90px ${shadowColor}, 0 0 100px ${shadowColor}, 0 0 150px ${shadowColor}`;
        };
    }
    
    adjustTextColor('heroSection');
</script>
<footer>
    <div class="logo">
        <a href="https://portfolio.argo.re/">
            <img src="/images/logo.png" alt="Site Logo">
        </a>
        <p>&copy; 2024 Pi Östberg</p>
        <a href="mailto:ostbergpi@gmail.com"><p>ostbergpi@gmail.com</p></a>
    </div>
    <nav>
        <ul>
        </ul>
    </nav>
    <script>
    window.store = {
    
    
    "https:\/\/portfolio.argo.re\/": {
        
        "title": "Pi Östberg",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/tags\/c\u002b\u002b\/": {
        
        "title": "C\u002b\u002b",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/tags\/c\u002b\u002b\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/tags\/engine\/": {
        
        "title": "Engine",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/tags\/engine\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/posts\/": {
        
        "title": "Posts",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/posts\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/tags\/": {
        
        "title": "Tags",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/tags\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/posts\/wyvern\/": {
        
        "title": "Wyvern",
            "tags": [ "C\u002b\u002b",  "Engine", ],
    "content": "\rWyvern is a 3D game engine developed from scratch by me.\nIts main goal is for me to learn about how engines function, but also to act as my main game engine because of my disappointment in already existing ones, such as Unity or Unreal Engine.\nThe source can be found on the github repository. NDA bound platform-specific code is kept on a private server.\nThis page will only outline some core features and explanations for certain design decisions.\nLibraries and frameworks Wyvern uses:\nLibrary Use Platforms GLFW Window Handling Windows SDL Window Handling All GLM Matrix Maths All Assimp Model Parsing All stb_image Image Parsing All ImGUI Debug UI All JoltPhysics Physics Windows MiniAudio Audio All nlohmann::json json parsing All XMake Build Tool The first thing to talk about is the build tool. Wyvern uses XMake, an open source Lua based build tool.\nIt\u0026rsquo;s my favourite build tool for a number of reasons, most notably because of how easy to use and set up it is.\nPlatforms The aim is to support Windows, Linux, Android, and some consoles (Nintendo 3DS, PlayStation, etc.). Currently it\u0026rsquo;s only been tested on Windows and WASM.\nUsing XMake I built up a relatively straight forward platforming-system that allows me to easily add more platforms and pick what it supports. Eg. Windows supports both GLFW and SDL, while WASM only supports SDL.\nThe Engine Wyvern uses a configuration setup, where the developer implements the wv::iApplication interface. This is used to set up and configure the engine and it\u0026rsquo;s subsystems, as well as inform the reflection system about any custom classes they may have implemented. Ownership of everything is then passed to the engine.\nA typical application implementation looks something like this;\nMyApplication.h Click to expand\r#pragma once #include \u0026lt;wv/Engine/Application.h\u0026gt; class cMyApplication : public wv::iApplication { public: cMyApplication() { } // Inherited via iApplication bool create ( void ) override; void run ( void ) override; void destroy( void ) override; }; MyApplication.cpp Click to expand\rbool cMyApplication::create( void ) { wv::EngineDesc engineDesc; engineDesc.windowWidth = 1280; engineDesc.windowHeight = 960; engineDesc.showDebugConsole = true; // create device context wv::ContextDesc ctxDesc; ctxDesc.deviceApi = wv::WV_DEVICE_CONTEXT_API_GLFW; ctxDesc.graphicsApi = wv::WV_GRAPHICS_API_OPENGL; ctxDesc.graphicsApiVersion.major = 3; ctxDesc.graphicsApiVersion.minor = 1; ctxDesc.name = \u0026#34;Wyvern Sandbox\u0026#34;; ctxDesc.width = engineDesc.windowWidth; ctxDesc.height = engineDesc.windowHeight; ctxDesc.allowResize = false; wv::iDeviceContext* deviceContext = wv::iDeviceContext::getDeviceContext( \u0026amp;ctxDesc ); deviceContext-\u0026gt;setSwapInterval( 0 ); // disable vsync // create graphics device wv::GraphicsDeviceDesc deviceDesc; deviceDesc.loadProc = deviceContext-\u0026gt;getLoadProc(); deviceDesc.pContext = deviceContext; wv::iGraphicsDevice* graphicsDevice = wv::iGraphicsDevice::createGraphicsDevice( \u0026amp;deviceDesc ); engineDesc.device.pContext = deviceContext; engineDesc.device.pGraphics = graphicsDevice; engineDesc.device.pAudio = new wv::AudioDevice( nullptr ); // set up modules wv::cFileSystem* fileSystem = new wv::cFileSystem(); fileSystem-\u0026gt;addDirectory( L\u0026#34;res/\u0026#34; ); fileSystem-\u0026gt;addDirectory( L\u0026#34;res/materials/\u0026#34; ); fileSystem-\u0026gt;addDirectory( L\u0026#34;res/meshes/\u0026#34; ); fileSystem-\u0026gt;addDirectory( L\u0026#34;res/shaders/\u0026#34; ); fileSystem-\u0026gt;addDirectory( L\u0026#34;res/textures/\u0026#34; ); engineDesc.systems.pFileSystem = fileSystem; engineDesc.systems.pShaderRegistry = new wv::cShaderRegistry( engineDesc.systems.pFileSystem, graphicsDevice ); // setup application state and scenes wv::cApplicationState* appState = new wv::cApplicationState(); engineDesc.pApplicationState = appState; wv::cSceneRoot* scene = appState-\u0026gt;loadScene( fileSystem, \u0026#34;res/scenes/defaultScene.json\u0026#34; ); appState-\u0026gt;addScene( scene ); // create engine m_pEngine = new wv::cEngine( \u0026amp;engineDesc ); return true; } Physics Wyvern uses the Jolt Physics Engine for real-time rigidbody physics.\nStress testing showed that it could handle about 6600 sphere bodies before going under 60 FPS. This is partly due to the not-optimal rendering however.\nReflection To allow for runtime scene object creation I developed a simple reflection system that takes advantage of static template variables.\nIt\u0026rsquo;s something I did earlier in my Reflection project with functions, but with classes.\nReflecting a class is as simple as using the REFLECT_CLASS() helper macro, and implementing the static createInstance and createInstanceJson functions. The macro expands into one line of code for you macro haters out there.\nSomething that I might change is the functions, as they\u0026rsquo;re currently required.\nI would much rather have virtual functions that you override. That way you don\u0026rsquo;t have to include createInstanceJson on classes that don\u0026rsquo;t need it.\nA basic reflected class:\n#pragma once #include \u0026lt;wv/Reflection/Reflection.h\u0026gt; class cPrinter { public: cPrinter() { printf( \u0026#34;a cPrinter was created\\n\u0026#34; ); } static cPrinter* createInstance ( void ) { return new cPrinter(); } static cPrinter* createInstanceJson( nlohmann::json\u0026amp; _json ) { return new cPrinter(); } } REFLECT_CLASS( cPrinter ); // expands to // wv::ClassReflect\u0026lt;cPrinter\u0026gt; wv::ClassReflector\u0026lt;cPrinter\u0026gt;::creator{ \u0026#34;cPrinter\u0026#34; }; It also works on templated classes, although each template has to be reflected individually\nREFLECT_CLASS( cPrinter\u0026lt;int\u0026gt; ); REFLECT_CLASS( cPrinter\u0026lt;float\u0026gt; ); REFLECT_CLASS( cPrinter\u0026lt;bool\u0026gt; ); Creating an instance of a reflected class would then be done through the cReflectionRegistry class\niSomeBaseClass* classObject1 = wv::cReflectionRegistry::createClassInstance( \u0026#34;cDerivedClass1\u0026#34; ); iSomeBaseClass* classObject2 = wv::cReflectionRegistry::createClassInstance( \u0026#34;cDerivedClass2\u0026#34; ); iSomeBaseClass* classObject3 = wv::cReflectionRegistry::createClassInstance( \u0026#34;cDerivedTemplate\u0026lt;bool\u0026gt;\u0026#34; ); iSomeBaseClass* classObject4 = wv::cReflectionRegistry::createClassInstance( \u0026#34;cDerivedTemplate\u0026lt;char\u0026gt;\u0026#34; ); ", 
    "url": "https:\/\/portfolio.argo.re\/posts\/wyvern\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/tags\/game\/": {
        
        "title": "Game",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/tags\/game\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/posts\/inthechamber\/": {
        
        "title": "In the Chamber",
            "tags": [ "Game",  "C\u002b\u002b",  "UnrealEngine5", ],
    "content": "In the Chamber is a twin-stick shooter where you play as a mummy defending the tomb from raiders.\nFor this project I worked on;\nDeveloping helper systems for the gameplay programmers PlayStation®5 DualSense Haptic Feedback interfacing Enemy AI Behaviour Final Boss Behaviour. PlayStation 5 Haptics For obvious reasons I cannot show a whole lot here. But here\u0026rsquo;s a snippet of the blueprint nodes that allowed the gameplay programmers and designers to add rumble and trigger effects.\nInterpolation Helper Our designers was struggling with figuring out interpolating values over time, so I worked on creating a basic lerp timer blueprint\nBHTimer.h Click to expand code block // inherit from FTickableGameObject and will therefore tick as if it is an Actor, but without requiring an instance UCLASS() class INTHECHAMBER_API UBHTimer : public UObject, public FTickableGameObject { GENERATED_BODY() public: // FTickableGameObject Begin virtual void Tick(float DeltaTime) override; virtual ETickableTickType GetTickableTickType( void ) const override { return ETickableTickType::Always; } virtual TStatId GetStatId ( void ) const override { RETURN_QUICK_DECLARE_CYCLE_STAT( UBHTimer, STATGROUP_Tickables ); } virtual bool IsTickableWhenPaused( void ) const override { return true; } virtual bool IsTickableInEditor ( void ) const override { return false; } // FTickableGameObject End UFUNCTION( BlueprintCallable, Category = \u0026#34;Blueprint Helper Timer\u0026#34; ) static FLerpTimerHandle createLerpTimer( FLerpDelegate Event, ELerpTimerModifier modifier, float startValue, float min = 0.0f, float max = 1.0f ); UFUNCTION( BlueprintCallable, Category = \u0026#34;Blueprint Helper Timer\u0026#34; ) static void startLerpTimer( FLerpTimerHandle timer, float target, float time, bool destroyOnFinished = false ); /* ... and a bunch of other functions ... */ private: uint32 LastFrameNumberWeTicked = INDEX_NONE; }; BHTimer.cpp Click to expand code block void UBHTimer::Tick( float DeltaTime ) { if ( LastFrameNumberWeTicked == GFrameCounter ) return; // remove timers marked for delete TArray\u0026lt;int32\u0026gt; timersMarkedForDelete; for ( auto\u0026amp; timerPair : lerpTimers ) { if( timerPair.Value.MarkedForDelete ) timersMarkedForDelete.Push( timerPair.Key );\t} for (int i = 0; i \u0026lt; timersMarkedForDelete.Num(); i++) lerpTimers.FindAndRemoveChecked( timersMarkedForDelete[ i ] ); // run tick on living timers for ( auto\u0026amp; TimerPair : lerpTimers ) { FLerpTimer\u0026amp; Timer = TimerPair.Value; if( !Timer.Running || !Timer.Event.IsBound() ) continue; Timer.InternalTimer += DeltaTime / Timer.Time; Timer.InternalTimer = FMath::Clamp( Timer.InternalTimer, 0.0f, 1.0f ); Timer.CurrentValue = FMath::Lerp( Timer.From, Timer.To, Timer.InternalTimer ); if( Timer.Modifier == ELerpTimerModifier::Clamp ) Timer.CurrentValue = FMath::Clamp( Timer.CurrentValue, Timer.Min, Timer.Max ); else if( Timer.Modifier == ELerpTimerModifier::Wrap ) Timer.CurrentValue = FMath::Wrap( Timer.CurrentValue, Timer.Min, Timer.Max ); const bool ReachedTarget = Timer.InternalTimer \u0026gt;= 1.0f; Timer.Event.Execute( Timer.CurrentValue, ReachedTarget, { TimerPair.Key } ); if ( ReachedTarget \u0026amp;\u0026amp; Timer.DestroyOnFinished ) Timer.MarkedForDelete = true; } LastFrameNumberWeTicked = GFrameCounter; } Bonus; Get Available Ammo Slot Blueprint Node Click to expand code block int32 UBHMisc::getAvailableAmmoSlot( float\u0026amp; angle, TArray\u0026lt;TEnumAsByte\u0026lt;EBulletWidgetState\u0026gt;\u0026gt; bulletStates, EBulletWidgetState match, bool reversed ) { int FoundIndex = 0; if( !reversed ) // get first available chamber slot clock-wise { for (int i = 0; i \u0026lt; bulletStates.Num(); i++) { if( bulletStates[ i ] != match ) continue; FoundIndex = i; break; } } else // get first available chamber slot counter-clock-wise { for (int i = bulletStates.Num() - 1; i \u0026gt;= 0; i--) { if( bulletStates[ i ] != match ) continue; FoundIndex = i; break; } } // 6 slot chamber, 60 degrees between each chamber angle = FoundIndex * 60.0f; return FoundIndex; } Final Boss Battle At the end of the project I also got assigned to work on the final boss battle.\nMost of this was built using already existing AI systems and such that I didn\u0026rsquo;t work on so I won\u0026rsquo;t include those.\nThe boss level in Unreal Engine 5 with all the triggers, spawn areas, and tools\nYour browser does not support the video tag. Demo of the Boss' Wave attack", 
    "url": "https:\/\/portfolio.argo.re\/posts\/inthechamber\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/tags\/unrealengine5\/": {
        
        "title": "UnrealEngine5",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/tags\/unrealengine5\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/posts\/beetlebot\/": {
        
        "title": "Beetlebot",
            "tags": [ "Game",  "C\u002b\u002b", ],
    "content": "Beetlebot is a 4 level dungeon crawler. It was our first game project at PlaygroundSquad and made in the game engine TenGine.\nI was tasked with building most of the core systems powering the game, such as the physics, collision detection, enemy pathfinding, as well as providing platform support for the PlayStation 5.\nFor this project I implemented :\nPhysics and Collisions Pathfinding PlayStation®5 DualSense Haptic Feedback Video Playback Miscellaneous entity systems Entity Collisions Entity-Entity and Entity-Static World collisions.\nThe collision code is some 600 lines of code so I won\u0026rsquo;t post that here\nMasse Pathfinding Early pathfinding test with a navmesh. Early on it was just a basic floodfill algorithm\nYour browser does not support the video tag. The grid shown is an optimization to reduce the amount of navmesh lookups. cNavmesh.cpp int cNavmesh::getNodeClosestToPosition( const tg::cVector3f\u0026amp; _position ) { unsigned int closest = 0; float closest_distance = 100000.0f; int chunk_pos = worldToChunkIndex( _position ); if ( chunk_pos.y \u0026lt; 0 || chunk_pos.y \u0026gt;= m_chunk_count || chunk_pos.x \u0026lt; 0 || chunk_pos.x \u0026gt;= m_chunk_count ) return -1; std::vector\u0026lt;unsigned int\u0026gt;\u0026amp; chunk = m_node_chunks[ chunk_pos.y ][ chunk_pos.x ]; for ( size_t i = 0; i \u0026lt; chunk.size(); i++ ) { float distance = ( m_nodes[ chunk[ i ] ].position - _position ).length(); if ( distance \u0026gt; closest_distance ) continue; closest_distance = distance; closest = (unsigned int)chunk[ i ]; } return closest; } Video Playback System (sound warning) Test of the video playback system implemented on Windows. It was relatively easy to port it to the PlayStation 5 with minimal stutter.\nI claim no ownership of the Aperture logo. All rights go to The Valve Corporation\nYour browser does not support the video tag. cVideo.cpp cVideo::cVideo( const std::string\u0026amp; _filename ) { std::string dir_path = \u0026#34;data/videos/\u0026#34; + _filename + \u0026#34;/\u0026#34;; std::string frames_path = dir_path + \u0026#34;frames/\u0026#34;; std::string settings_path = dir_path + \u0026#34;movie-settings.json\u0026#34;; uint8_t* data = tg::cFileSystem::getInstance().fileLoad( settings_path ); if ( !data ) // failed to load settings return; nlohmann::json json_root = nlohmann::json::parse( data ); TG_MEMORY_FREE( data ); m_framerate = json_root.value( \u0026#34;framerate\u0026#34;, 24.0f ); std::string audio_path = json_root.value( \u0026#34;audio\u0026#34;, \u0026#34;\u0026#34; ); loadFrameList( dir_path ); loadFrames(); catchFrames(); if( audio_path != \u0026#34;\u0026#34; ) m_audio = cAudio::getInstance().createAudioFile( dir_path + audio_path ); m_sprite = new tg::cSprite(); m_sprite-\u0026gt;create( _name, { 1920.0f / 1.0f, 1080.0f / 2.0f, 0 }, { 1920, 1080 }, tg::Color::kWhite, nullptr ); m_sprite-\u0026gt;setTexCoords( 1.0f, 0.0f, 1.0f, 0.0f ); } ", 
    "url": "https:\/\/portfolio.argo.re\/posts\/beetlebot\/"
        },
    
    
    "https:\/\/portfolio.argo.re\/categories\/": {
        
        "title": "Categories",
            "tags": [],
    "content": "", 
    "url": "https:\/\/portfolio.argo.re\/categories\/"
        },
    
    }
</script>

<script src="/js/lunr.min.js"></script>
<script src="/js/search.js"></script>

</footer>
</body>
</html>
